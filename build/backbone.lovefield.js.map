{"version":3,"sources":["webpack://Backbone.LoveField/webpack/universalModuleDefinition","webpack://Backbone.LoveField/webpack/bootstrap","webpack://Backbone.LoveField/(webpack)/buildin/global.js","webpack://Backbone.LoveField/./src/driver.coffee","webpack://Backbone.LoveField/./src/store.coffee","webpack://Backbone.LoveField/./src/sync.coffee","webpack://Backbone.LoveField/./src/utils.coffee","webpack://Backbone.LoveField/external {\"amd\":\"backbone\",\"commonjs\":\"backbone\",\"commonjs2\":\"backbone\",\"root\":\"Backbone\"}","webpack://Backbone.LoveField/external {\"amd\":\"lovefield\",\"commonjs\":\"lovefield\",\"commonjs2\":\"lovefield\",\"root\":\"lf\"}","webpack://Backbone.LoveField/external {\"amd\":\"underscore\",\"commonjs\":\"underscore\",\"commonjs2\":\"underscore\",\"root\":\"_\"}"],"names":[],"mappings":"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","file":"backbone.lovefield.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"backbone\"), require(\"lovefield\"), require(\"underscore\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"backbone\", \"lovefield\", \"underscore\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Backbone.LoveField\"] = factory(require(\"backbone\"), require(\"lovefield\"), require(\"underscore\"));\n\telse\n\t\troot[\"Backbone.LoveField\"] = factory(root[\"Backbone\"], root[\"lf\"], root[\"_\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE_backbone__, __WEBPACK_EXTERNAL_MODULE_lovefield__, __WEBPACK_EXTERNAL_MODULE_underscore__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import Backbone from 'backbone'\n\nimport {sync as localSync } from './sync'\nimport { LoveStore } from './store'\nimport { getLoveStore } from './utils'\n\nBackbone.LoveStore = LoveStore\najaxSync = Backbone.sync\n\n###* Get the local or ajax sync call\n# @param {Model} model - Model to sync\n# @param {object} options - Options to pass, takes ajaxSync\n# @returns {function} The sync method that will be called\n###\ngetSyncMethod = (model, options={}) ->\n  forceAjaxSync = options.ajaxSync\n  hasLoveStore = getLoveStore(model)\n  return if not forceAjaxSync and hasLoveStore then localSync else ajaxSync\n  \nBackbone.sync = (method, model, options) ->\n  return getSyncMethod(model, options).apply(@, [method, model, options])\n\nexport { LoveStore }\n","import { result } from 'underscore'\nimport lf from 'lovefield'\nimport { guid } from './utils'\n\nexport class LoveStore\n  constructor: (@conn, @name='') ->\n    return\n  _getTable: ->\n    return @conn.getSchema().table(@name)\n  create: (model) ->\n    table = @_getTable()\n    idAttribute = result(model, 'idAttribute')\n    id = result(model, idAttribute)\n    if not id and id isnt 0\n      model.id = guid()\n      model.set(model.idAttribute, model.id)\n    data = model.toJSON()\n    row = table.createRow data\n    return @conn.insert().into(table).values([row]).exec()\n  update: (model) ->\n    table = @_getTable()\n    data = model.toJSON()\n    q = @conn.update(table)\n    Object.keys(data).forEach (key) ->\n      q = q.set(table[key], data[key])\n    q = q.where(table.id.eq(data.id))\n    return q.exec()\n  find: (model, options) ->\n    table = @_getTable()\n    idAttribute = result(model, 'idAttribute')\n    id = result(model, idAttribute)\n    return q = @conn.select().from(table).where(table.id.eq(id))\n    .exec().then (results) ->\n      model.set results[0]\n      return model\n    return q\n  findAll: (model, options) ->\n    table = @_getTable()\n    q = @conn.select().from(table)\n    if options.data\n      filters = []\n      Object.keys(options.data).forEach (key) ->\n        clause = table[key].eq(options.data[key])\n        filters.push clause\n      if filters.length > 1\n        q = q.where(lf.op.and(filters))\n      else\n        q = q.where(filters[0])\n    return q.exec().then (results) ->\n      if model instanceof Backbone.Collection\n        return model.set results\n      else\n        # FIXME throw error if more\n        # than one result for model\n        return model.set results[0]\n  destroy: (model, options) ->\n    table = @_getTable()\n    return @conn.delete().from(table).where(table.id.eq(model.id)).exec()\n    \n    \n","import Bb from 'backbone'\nimport { isUndefined, result } from 'underscore'\nimport { getLoveStore } from './utils'\n###* Get the Deferred status from $ if we have jQuery, otherwise use Backbone's\n#  @returns {boolean} - Whether the request was deferred\n###\ngetDeferred = ->\n  if Bb.$\n    return result(Bb.$, 'Deferred', false)\n  return result(Bb, 'Deferred', false)\n\n\n###* Override Backbone's `sync` method to run against localStorage\n# @param {string} method - One of read/create/update/delete\n# @param {Model} model - Backbone model to sync\n# @param {Object} options - Options object, use `ajaxSync: true` to run the\n#  operation against the server in which case, options will also be passed into\n#  `jQuery.ajax`\n# @returns {undefined}\n###\nexport sync = (method, model, options={}) ->\n  store = getLoveStore model\n  resp = undefined\n  try\n    switch (method)\n      when 'read'\n        idAttribute = result(model, 'idAttribute')\n        id = result(model, idAttribute)\n        resp = if id then store.find(model, options) else store.findAll(model, options) #noqa\n      when 'create'\n        resp = store.create(model, options)\n      when 'patch', 'update'\n        resp = store.update(model, options)\n      when 'delete'\n        resp = store.destroy(model, options)\n  catch error\n    if error.code == 22\n      errorMessage = 'Private browsing is unsupported'\n    else\n      errorMessage = error.message\n\n  if resp\n    # compatibility with $.ajax\n    resp.done = resp.then\n    resp.fail = resp.catch\n    if options.success\n      options.success.call model, resp, options\n  else\n    errorMessage = if errorMessage then errorMessage else \"Record Not Found\"\n    if options.error\n      options.error.call model, errorMessage, options\n\n  # add compatibility with $.ajax\n  # always execute callback for success and error\n  if options.complete\n    options.complete.call model, resp\n\n  return resp\n  \n","import { isUndefined, result } from 'underscore'\n\ns4 = ->\n  rand = (1 + Math.random()) * 0x10000\n  return (rand | 0).toString(16).substring(1)\n\nexport guid = ->\n  return \"#{s4()}#{s4()}-#{s4()}-#{s4()}-#{s4()}-#{s4()}#{s4()}#{s4()}\"\n\nexport getLoveConnection = (model) ->\n  conn = result(model, 'loveConnection')\n  return conn or result(model.collection, 'loveConnection')\n\nexport getTableName = (model) ->\n  tableName = result(model, 'tableName')\n  return tableName or result(model.collection, 'tableName')\n  \nexport getWindow = ->\n  return if isUndefined(window) then global else window\n  \n\nexport getLoveStore = (model) ->\n  store = result(model, 'loveStore')\n  return store or result(model.collection, 'loveStore')\n  \n","module.exports = __WEBPACK_EXTERNAL_MODULE_backbone__;","module.exports = __WEBPACK_EXTERNAL_MODULE_lovefield__;","module.exports = __WEBPACK_EXTERNAL_MODULE_underscore__;"],"sourceRoot":""}