!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("underscore"),require("backbone"),require("lovefield")):"function"==typeof define&&define.amd?define(["underscore","backbone","lovefield"],t):"object"==typeof exports?exports["Backbone.LoveField"]=t(require("underscore"),require("backbone"),require("lovefield")):e["Backbone.LoveField"]=t(e._,e.Backbone,e.lf)}(window,function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){"use strict";(function(e){r.d(t,"b",function(){return c}),r.d(t,"a",function(){return i});var n,o=r(0);n=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};var c=function(){return`${n()}${n()}-${n()}-${n()}-${n()}-${n()}${n()}${n()}`},i=function(e){return Object(o.result)(e,"loveStore")||Object(o.result)(e.collection,"loveStore")}}).call(this,r(5))},function(e,t){e.exports=r},function(e,t,r){"use strict";r.r(t);var n=r(1),o=r.n(n),c=r(0),i=r(2);var u,a,s=function(e,t,r={}){var n,o,c,u;u=Object(i.a)(t),c=void 0;try{switch(e){case"read":c=t.id?u.find(t,r):u.findAll(t,r);break;case"create":c=u.create(t,r);break;case"patch":case"update":c=u.update(t,r);break;case"delete":c=u.destroy(t,r)}}catch(e){o=22===(n=e).code?"Private browsing is unsupported":n.message}return c?(c.done=c.then,c.fail=c.catch,r.success&&r.success.call(t,c,r)):(o=o||"Record Not Found",r.error&&r.error.call(t,o,r)),r.complete&&r.complete.call(t,c),c},d=r(3),l=r.n(d),f=class{constructor(e,t=""){this.conn=e,this.name=t}_getTable(){return this.conn.getSchema().table(this.name)}create(e){var t,r,n;return n=this._getTable(),e.id||0===e.id||(e.id=Object(i.b)(),e.set(e.idAttribute,e.id)),t=e.toJSON(),r=n.createRow(t),this.conn.insert().into(n).values([r]).exec()}update(e){var t,r,n;return n=this._getTable(),t=e.toJSON(),r=this.conn.update(n),Object.keys(t).forEach(function(e){return r=r.set(n[e],t[e])}),(r=r.where(n.id.eq(t.id))).exec()}find(e,t){var r;return r=this._getTable(),this.conn.select().from(r).where(r.id.eq(e.id)).exec().then(function(t){return e.set(t[0]),e})}findAll(e,t){var r,n,o;return o=this._getTable(),n=this.conn.select().from(o),t.data&&(r=[],Object.keys(t.data).forEach(function(e){var n;return n=o[e].eq(t.data[e]),r.push(n)}),n=r.length>1?n.where(l.a.op.and(r)):n.where(r[0])),n.exec().then(function(t){return e instanceof Backbone.Collection?e.set(t):e.set(t[0])})}destroy(e,t){var r;return r=this._getTable(),this.conn.delete().from(r).where(r.id.eq(e.id)).exec()}};r.d(t,"LoveStore",function(){return f}),o.a.LoveStore=f,u=o.a.sync,a=function(e,t={}){var r,n;return r=t.ajaxSync,n=Object(i.a)(e),!r&&n?s:u},o.a.sync=function(e,t,r){return a(t,r).apply(this,[e,t,r])}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){e.exports=r(4)}])});